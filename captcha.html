<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Turnstile</title>

  <link rel="preconnect" href="https://challenges.cloudflare.com">
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

  <style>
    body { margin:0; font-family: Arial, sans-serif; background: transparent; }
    .wrap { display:flex; align-items:center; justify-content:center; height:100vh; }
    .hint { color:#666; font-size:14px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hint">Verificandoâ€¦</div>
    <div class="cf-turnstile"
         data-sitekey="0x4AAAAAACNJalFqU3pVBzT2"
         data-callback="onSuccess"
         data-error-callback="onError"
         data-expired-callback="onExpired"
         data-timeout-callback="onError"
         data-size="invisible"></div>
  </div>

  <script>
    function hasFlutterChannel() {
      return !!(window.Captcha && window.Captcha.postMessage);
    }

    function send(msg) {
      if (hasFlutterChannel()) {
        window.Captcha.postMessage(String(msg));
      }
    }

    function goDone(fragment) {
      // Token/error is placed in URL fragment (#...), not sent to the server.
      window.location.replace('captcha_done.html#' + fragment);
    }

    function sendWithFallback(msg, fragment) {
      // Always try the JS channel first (fast on Android/iOS/mac).
      send(msg);

      // Fallback for platforms where JS channel is missing (Windows WebView2),
      // or if the channel fails silently.
      setTimeout(function() {
        goDone(fragment);
      }, 350);
    }

    function onSuccess(token) {
      const t = (token || '').trim();
      if (!t) {
        sendWithFallback("ERROR", "error=EMPTY");
        return;
      }
      sendWithFallback(t, "token=" + encodeURIComponent(t));
    }

    function onError() {
      sendWithFallback("ERROR", "error=ERROR");
    }

    function onExpired() {
      sendWithFallback("EXPIRED", "error=EXPIRED");
    }
  </script>
</body>
</html>
